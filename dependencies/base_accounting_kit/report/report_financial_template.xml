<?xml version="1.0" encoding="utf-8" ?>
<odoo>
    <template id="report_financial">
        <t t-call="web.html_container">
            <t t-call="web.internal_layout">
                <t t-set="data_report_margin_top" t-value="12"/>
                <t t-set="data_report_header_spacing" t-value="9"/>
                <t t-set="data_report_dpi" t-value="110"/>
                <style>
                    .modern-report-card {
                        background: white;
                        border-radius: 8px;
                        padding: 24px;
                        margin: 16px auto;
                        box-shadow: 0 1px 3px rgba(0,0,0,0.1);
                        margin-bottom: 100px;

                    }
                    .modern-report-header {
                        margin-bottom: 20px;
                        padding-bottom: 12px;
                        border-bottom: 1px solid #e0e0e0;
                        overflow: hidden;
                    }
                    .modern-report-header-table {
                        width: 100%;
                        border-collapse: collapse;
                        border: none;
                    }
                    .modern-report-header-table td {
                        padding: 0;
                        vertical-align: middle;
                        border: none;
                    }
                    .modern-report-header-table tr {
                        border: none;
                    }
                    .modern-report-header-table td:first-child {
                        width: 70%;
                    }
                    .modern-report-header-table td:last-child {
                        width: 30%;
                        text-align: right;
                    }
                    .modern-report-title {
                        font-size: 20px;
                        font-weight: 600;
                        margin: 0;
                    }
                    .modern-year-badge {
                        background: white;
                        border: 1px solid #ddd;
                        padding: 8px 16px;
                        border-radius: 4px;
                        font-size: 14px;
                        display: inline-block;
                    }
                    .modern-report-lines {
                        margin-top: 16px;
                    }
                    .modern-report-line {
                        padding: 8px 0;
                        min-height: 32px;
                        overflow: hidden;
                    }
                    .modern-report-line-table {
                        width: 100%;
                        border-collapse: collapse;
                        border: none;
                    }
                    .modern-report-line-table td {
                        padding: 8px 0;
                        vertical-align: middle;
                        border: none;
                    }
                    .modern-report-line-table tr {
                        border: none;
                    }
                    td, tr, table, tbody, thead, tfoot {
                        border: none !important;
                    }
                    .modern-report-line-table td:first-child {
                        width: 70%;
                    }
                    .modern-report-line-table td:last-child {
                        width: 30%;
                        text-align: right;
                    }
                    .modern-report-line-highlight {
                        background-color: #f5f5f5;
                        padding: 12px;
                        margin: 4px 0;
                        border-radius: 4px;
                        font-weight: 600;
                    }
                    .modern-line-name {
                        display: block;
                    }
                    .modern-line-indent {
                        width: 16px;
                        display: inline-block;
                    }
                    .modern-line-chevron {
                        width: 16px;
                        color: #999;
                        margin-right: 8px;
                        display: inline-block;
                    }
                    .modern-line-content {
                        display: inline-block;
                    }
                    .modern-line-balance {
                        display: inline-block;
                    }
                    .modern-info-icon {
                        color: #999;
                        font-size: 12px;
                    }
                    .modern-balance-header {
                        font-weight: 500;
                        color: #666;
                        text-align: right;
                        margin: 0 16px;
                    }
                    .modern-report-line-bold {
                        font-weight: 600;
                    }
                </style>
                <div class="page">
                    <!-- Old implementation -->
                    <!-- <h2 t-esc="data['form']['account_report_id'][1]"/>
                        <div class="row mt32 mb32">
                            <div class="col-4">
                                <strong>Target Moves:</strong>
                                <p>
                                    <span t-if="data['form']['target_move'] == 'all'">All Entries</span>
                                    <span t-if="data['form']['target_move'] == 'posted'">All Posted Entries</span>
                                </p>
                            </div>
                            <div class="col-4">
                                <p>
                                    <t t-if="data['form']['date_from']">
                                        <strong>Date from :</strong>
                                        <span t-esc="data['form']['date_from']"/>
                                        <br/>
                                    </t>
                                    <t t-if="data['form']['date_to']">
                                        <strong>Date to :</strong>
                                        <span t-esc="data['form']['date_to']"/>
                                    </t>
                                </p>
                            </div>
                        </div>
                        <table class="table table-sm table-reports" t-if="data['form']['debit_credit'] == 1">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th class="text-right">Debit</th>
                                    <th class="text-right">Credit</th>
                                    <th class="text-right">Balance</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr t-foreach="report_lines" t-as="a">
                                    <t t-if="a['level'] != 0">
                                        <t t-if="a.get('level') &gt; 3">
                                            <t t-set="style" t-value="'font-weight: normal;'"/>
                                        </t>
                                        <t t-if="not a.get('level') &gt; 3">
                                            <t t-set="style" t-value="'font-weight: bold;'"/>
                                        </t>

                                        <td>
                                            <span style="color: white;" t-esc="'..' * a.get('level', 0)"/>
                                            <span t-att-style="style" t-esc="a.get('name')"/>
                                        </td>
                                        <td class="text-right" style="white-space: text-nowrap;">
                                            <span t-att-style="style" t-esc="a.get('debit')" t-options="{'widget': 'monetary', 'display_currency': env.company.currency_id}"/>
                                        </td>
                                        <td class="text-right" style="white-space: text-nowrap;">
                                            <span t-att-style="style" t-esc="a.get('credit')" t-options="{'widget': 'monetary', 'display_currency': env.company.currency_id}"/>
                                        </td>
                                        <td class="text-right" style="white-space: text-nowrap;">
                                            <span t-att-style="style" t-esc="a.get('balance')" t-options="{'widget': 'monetary', 'display_currency': env.company.currency_id}"/>
                                        </td>
                                    </t>
                                </tr>
                            </tbody>
                        </table>

                        <table class="table table-sm table-reports" t-if="not data['form']['enable_filter'] and not data['form']['debit_credit']">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th class="text-right">Balance</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr t-foreach="report_lines" t-as="a">
                                    <t t-if="a['level'] != 0">
                                        <t t-if="a.get('level') &gt; 3">
                                            <t t-set="style" t-value="'font-weight: normal;'"/>
                                        </t>
                                        <t t-if="not a.get('level') &gt; 3">
                                            <t t-set="style" t-value="'font-weight: bold;'"/>
                                        </t>

                                        <td>
                                            <span style="color: white;" t-esc="'..' * a.get('level', 0)"/>
                                            <span t-att-style="style" t-esc="a.get('name')"/>
                                        </td>
                                        <td class="text-right">
                                            <span t-att-style="style" t-esc="a.get('balance')" t-options="{'widget': 'monetary', 'display_currency': env.company.currency_id}"/>
                                        </td>
                                    </t>
                                </tr>
                            </tbody>
                        </table>

                        <table class="table table-sm table-reports" t-if="data['form']['enable_filter'] == 1 and not data['form']['debit_credit']">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th class="text-right">Balance</th>
                                    <th class="text-right">
                                        <span>Comp</span>
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr t-foreach="report_lines" t-as="a">
                                    <t t-if="a['level'] != 0">
                                        <t t-if="a.get('level') &gt; 3">
                                            <t t-set="style" t-value="'font-weight: normal;'"/>
                                        </t>
                                        <t t-if="not a.get('level') &gt; 3">
                                            <t t-set="style" t-value="'font-weight: bold;'"/>
                                        </t>
                                        <td>
                                            <span style="color: white;" t-esc="'..'"/>
                                            <span t-att-style="style" t-esc="a.get('name')"/>
                                        </td>
                                        <td class="text-end">
                                            <span t-att-style="style" t-esc="a.get('balance')" t-options="{'widget': 'monetary', 'display_currency': env.company.currency_id}"/>
                                        </td>
                                        <td class="text-end">
                                            <span t-att-style="style" t-esc="a.get('balance_cmp')"/>
                                        </td>
                                    </t>
                                </tr>
                            </tbody>
                        </table> -->
                    <!-- New implementation -->
                    <div class="modern-report-card">
                        <div class="modern-report-header">
                            <table class="modern-report-header-table">
                                <tr>
                                    <td>
                                        <h2 class="modern-report-title" t-esc="data['form']['account_report_id'][1]"/>
                                    </td>
                                    <td>
                                        <div class="modern-year-badge">
                                            <span t-esc="report_year"/>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>

                        <div class="modern-balance-header" style="padding-bottom: 12px; border-bottom: 1px solid #e0e0e0; margin-bottom: 16px;">
                            Balance
                        </div>

                        <div class="modern-report-lines">
                            <t t-foreach="report_lines" t-as="line">
                                <t t-if="line.get('level', 0) != 0">
                                    <t t-set="line_level" t-value="line.get('level', 1)"/>


                                    <t t-set="is_highlighted" t-value="line_level == 1"/>
                                    <t t-set="is_arrow_highlighted" t-value="line_level == 2"/>
                                    <t t-set="is_bold" t-value="line_level == 3"/>
                                    <t t-set="indent_px" t-value="(line_level - 1) * 20"/>
                                    <t t-set="is_rtl" t-value="env.lang and env.lang.split('_')[0] in ['ar', 'he', 'fa', 'ur', 'yi', 'ji']"/>
                                    <t t-set="padding_style" t-value="is_rtl and ('padding-right: %dpx;' % indent_px) or ('padding-left: %dpx;' % indent_px)"/>
                                    <t t-set="chevron_symbol" t-value="is_rtl and '◀' or '▶'"/>

                                    <div t-attf-class="modern-report-line #{(is_highlighted or is_arrow_highlighted) and 'modern-report-line-highlight' or ''} #{is_bold and 'modern-report-line-bold' or ''}">
                                        <table class="modern-report-line-table">
                                            <tr>
                                                <td t-att-style="padding_style">
                                                    <div class="modern-line-name">
                                                        <t t-if="is_arrow_highlighted">
                                                            <span class="modern-line-chevron" t-esc="chevron_symbol"/>
                                                        </t>
                                                        <span class="modern-line-content" t-att-style="is_bold and 'font-weight: 600;' or ''">
                                                            <span t-esc="line['name']"/>
                                                        </span>
                                                    </div>
                                                </td>
                                                <td>
                                                    <div class="modern-line-balance">
                                                        <span >
                                                            <span t-esc="line['balance']" t-options="{'widget': 'monetary', 'display_currency': env.company.currency_id}"/>
                                                        </span>
                                                    </div>
                                                </td>
                                            </tr>
                                        </table>
                                    </div>
                                </t>
                            </t>
                        </div>
                    </div>
                </div>
            </t>
        </t>
    </template>
</odoo>
